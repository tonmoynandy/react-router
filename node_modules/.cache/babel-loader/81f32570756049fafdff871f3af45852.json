{"ast":null,"code":"var _jsxFileName = \"D:\\\\MY_WORK\\\\react-routing-test\\\\src\\\\components\\\\FriendZone.js\";\nimport React from 'react';\nimport UserMenu from './UserMenu';\nimport { DbHelper } from '../DbHelper';\n\nclass FriendZone extends React.Component {\n  constructor() {\n    this.state = {\n      errors: '',\n      success: '',\n      searchUsers: [],\n      inviteFriends: [],\n      friends: [],\n      user: JSON.parse(sessionStorage.getItem(\"_u\"))\n    };\n  }\n\n  componentDidMount() {\n    this.getFriendList();\n    this.inviteFriends();\n  }\n\n  checkFriend(friendId) {\n    let checkRequest = DbHelper.find('friend_requests', [['user_id', this.state.user._id], ['friend_id', friendId]]);\n    return checkRequest;\n  }\n\n  statusChangeRequest(friend, status) {\n    DbHelper.update('friend_requests', [['_id', friend._id]], {\n      'status': status\n    });\n\n    if (status === 'A') {\n      DbHelper.insert('friend_requests', {\n        friend_id: friend.user_id,\n        user_id: this.state.user._id,\n        status: 'A'\n      });\n    }\n\n    this.setState({\n      success: 'Request is  ' + (status == 'A' ? 'accepted' : 'rejected')\n    });\n    setTimeout(() => {\n      this.setState({\n        success: null\n      });\n    }, 3000);\n    this.inviteFriends();\n  }\n\n  getFriendList() {\n    let requestsList = JSON.parse(localStorage.getItem('friend_requests'));\n    let resultData = [];\n    let friendContent = [];\n    resultData = requestsList.filter(i => {\n      return i.user_id == this.state.user._id && i.status == 'A';\n    });\n    friendContent = resultData.map(i => {\n      let user = DbHelper.find('users', [['_id', i.friend_id]]);\n      return React.createElement(\"div\", {\n        className: \"card\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, user.name)));\n    });\n    this.setState({\n      'friends': friendContent\n    });\n  }\n\n  render() {\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"Friend Zone\")), React.createElement(\"div\", {\n      className: \"col-7 text-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(UserMenu, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"card-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"Search Friend\"), this.state.success && React.createElement(\"div\", {\n      className: \"alert alert-success text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, this.state.success), this.state.errors && React.createElement(\"div\", {\n      className: \"alert alert-danger text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, this.state.errors), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Search Friends...\",\n      className: \"form-control\",\n      onKeyUp: this.searchFriends,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, this.state.searchUsers))), React.createElement(\"div\", {\n      className: \"card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"card-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Invitation\"), React.createElement(\"div\", {\n      className: \"d-flex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, this.state.inviteFriends))), React.createElement(\"div\", {\n      className: \"card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"card-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"Friends\"), React.createElement(\"div\", {\n      className: \"d-flex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, this.state.friends))));\n  }\n\n}\n\nexport default FriendZone;","map":{"version":3,"sources":["D:/MY_WORK/react-routing-test/src/components/FriendZone.js"],"names":["React","UserMenu","DbHelper","FriendZone","Component","constructor","state","errors","success","searchUsers","inviteFriends","friends","user","JSON","parse","sessionStorage","getItem","componentDidMount","getFriendList","checkFriend","friendId","checkRequest","find","_id","statusChangeRequest","friend","status","update","insert","friend_id","user_id","setState","setTimeout","requestsList","localStorage","resultData","friendContent","filter","i","map","name","render","searchFriends"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport UserMenu from './UserMenu';\r\nimport {DbHelper} from '../DbHelper';\r\nclass FriendZone extends React.Component {\r\n\r\n    constructor() {\r\n      this.state = {\r\n        errors:'',\r\n        success:'',\r\n        searchUsers:[],\r\n        inviteFriends:[],\r\n        friends:[],\r\n        user:JSON.parse(sessionStorage.getItem(\"_u\")),\r\n      }\r\n      \r\n    }\r\n    componentDidMount() {\r\n      this.getFriendList();\r\n      this.inviteFriends();\r\n    }\r\n\r\n    checkFriend(friendId) {\r\n      let checkRequest = DbHelper.find('friend_requests',[\r\n        ['user_id', this.state.user._id],\r\n        ['friend_id',friendId]\r\n      ]);\r\n      return checkRequest;\r\n    }\r\n    sendRequest = (friend)=>{\r\n      let checkRequest =this.checkFriend(friend._id);\r\n      if (!checkRequest) {\r\n        DbHelper.insert('friend_requests',{\r\n        user_id:this.state.user._id,\r\n        friend_id:friend._id,\r\n        status:'P'\r\n      });\r\n     \r\n      this.setState({success:'Request is  sent'});\r\n        setTimeout(()=>{\r\n          this.setState({success:null});\r\n        },3000);\r\n      } else {\r\n        this.setState({errors:'Request is already sent'});\r\n        setTimeout(()=>{\r\n          this.setState({errors:null});\r\n        },3000);\r\n      }\r\n      \r\n    }\r\n    searchFriends = (event)=>{\r\n      let users = JSON.parse(localStorage.getItem('users'));\r\n      let keyword = event.target.value;\r\n      let resultData = [];\r\n      let searchUsersContent = [];\r\n      if (keyword) {\r\n        resultData = users.filter((i)=>{\r\n          return i._id!=this.state.user._id && i.name.indexOf(keyword) > -1;\r\n        });\r\n        \r\n        resultData.forEach((i)=>{\r\n          searchUsersContent.push(\r\n            <div className=\"card\">\r\n            <div className=\"card-body d-flex\">\r\n            <div className=\"col\">{i.name}</div>\r\n            <div className=\"col text-right\"><button className=\"btn btn-primary btn-sm\" disabled={this.checkFriend(i._id)}  onClick={()=>{this.sendRequest(i)}}>Send</button></div>\r\n            </div>\r\n            </div>\r\n          )\r\n        })\r\n        \r\n      } else {\r\n        searchUsersContent = [];\r\n      }\r\n      this.setState({searchUsers:searchUsersContent});\r\n    }\r\n\r\n    statusChangeRequest(friend,status) {\r\n      DbHelper.update('friend_requests',[['_id',friend._id]],{'status':status});\r\n      if (status==='A') {\r\n        DbHelper.insert('friend_requests',{\r\n        friend_id:friend.user_id,\r\n        user_id:this.state.user._id,\r\n        status:'A'\r\n      });\r\n      }\r\n      this.setState({success:'Request is  '+((status=='A')?'accepted':'rejected')});\r\n        setTimeout(()=>{\r\n          this.setState({success:null});\r\n        },3000);\r\n      this.inviteFriends();\r\n    }\r\n    inviteFriends = ()=>{\r\n      let requestsList = JSON.parse(localStorage.getItem('friend_requests'));\r\n      let resultData = [];\r\n      let requestFriendContent = [];\r\n        resultData = requestsList.filter((i)=>{\r\n          return i.friend_id == this.state.user._id && i.status=='P';\r\n        });\r\n        requestFriendContent = resultData.map((i)=>{\r\n          let user = DbHelper.find('users',[['_id',i.user_id]]);\r\n            return (<div className=\"card\">\r\n            <div className=\"card-body  text-center\">\r\n            <div >{user.name}</div>\r\n            <div ><button className=\"btn btn-primary btn-sm\"   onClick={()=>{this.statusChangeRequest(i,'A')}}>Accept</button> <button className=\"btn btn-danger btn-sm\"   onClick={()=>{this.statusChangeRequest(i,'R')}}>Reject</button></div>\r\n            </div>\r\n            </div>)\r\n        })\r\n       this.setState({'inviteFriends':requestFriendContent});\r\n    }\r\n\r\n    getFriendList() {\r\n      let requestsList = JSON.parse(localStorage.getItem('friend_requests'));\r\n      let resultData = [];\r\n      let friendContent = [];\r\n        resultData = requestsList.filter((i)=>{\r\n          return i.user_id == this.state.user._id && i.status=='A';\r\n        });\r\n        friendContent = resultData.map((i)=>{\r\n          let user = DbHelper.find('users',[['_id',i.friend_id]]);\r\n            return (\r\n              <div className=\"card\">\r\n            <div className=\"card-body\">\r\n            <div className=\"col\">{user.name}</div>\r\n            \r\n            </div>\r\n            </div>)\r\n        })\r\n       this.setState({'friends':friendContent});\r\n    }\r\n    render (){\r\n      return (\r\n        <React.Fragment>\r\n      <div className=\"row\">\r\n      <div className=\"col-5\">\r\n      <h4>Friend Zone</h4>\r\n      </div>\r\n      <div className=\"col-7 text-right\">\r\n      <UserMenu/>\r\n      </div>\r\n      </div>\r\n      <div className=\"card\">\r\n        <div className=\"card-body\">\r\n        <h5 className=\"card-title\">Search Friend</h5>\r\n        {this.state.success &&\r\n          <div className=\"alert alert-success text-center\">\r\n          {this.state.success}\r\n          </div>\r\n          }\r\n          {this.state.errors &&\r\n          <div className=\"alert alert-danger text-center\">\r\n          {this.state.errors}\r\n          </div>\r\n          }\r\n        <div className=\"form-group\">\r\n        <input type=\"text\" placeholder=\"Search Friends...\" className=\"form-control\" onKeyUp={this.searchFriends} />\r\n        </div>\r\n        <div>\r\n        {this.state.searchUsers}\r\n        </div>\r\n  \r\n        </div>\r\n      </div>\r\n      <div className=\"card\">\r\n        <div className=\"card-body\">\r\n        <h5 className=\"card-title\">Invitation</h5>\r\n        <div className=\"d-flex\">\r\n        {this.state.inviteFriends}\r\n        </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"card\">\r\n        <div className=\"card-body\">\r\n        <h5 className=\"card-title\">Friends</h5>\r\n        <div className=\"d-flex\">\r\n        {this.state.friends}</div>\r\n        </div>\r\n      </div>\r\n      </React.Fragment>\r\n      );\r\n    }\r\n}\r\nexport default FriendZone;"]},"metadata":{},"sourceType":"module"}